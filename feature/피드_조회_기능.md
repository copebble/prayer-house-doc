# ê°ì¢… í”¼ë“œ ì¡°íšŒ ê´€ë ¨ ê¸°ëŠ¥

<br>

## ğŸ“Œ ë‚´ê°€ ì¢‹ì•„ìš”í•œ ê¸°ë„ ì œëª© ë‚´ì—­ í”¼ë“œ

1. select ì¿¼ë¦¬ ì‘ì„±ì‹œ prayer_likes(ê¸°ë„ ì œëª© ì¢‹ì•„ìš”), prayer_lapses(ê¸°ë„ ì œëª© ê²½ê³¼) ë‘ ê°œë¥¼ inner joinìœ¼ë¡œ ë¬¶ì–´ì„œ ì§„í–‰
2. ë¨¼ì € prayer_likes covering index ì¡°íšŒ í›„ prayer_lapses id ê°’ in ì ˆ ì¡°íšŒ


### ê¸°ë„ ì œëª© ì¢‹ì•„ìš” í…Œì´ë¸” ê´€ë ¨

```sql
CREATE UNIQUE INDEX uk_prayerlapseid_memberid ON prayer_likes (prayer_lapse_id, member_id);
CREATE INDEX ix_memberid_prayerlapseid ON prayer_likes (member_id, prayer_lapse_id DESC);
```
covering indexë¡œ ì¿¼ë¦¬ ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•´ unique indexì™€ index ë‘ ê°œ ì¶”ê°€
ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì¡°íšŒ ì„±ëŠ¥ì„ ìš°ì„ ì‹œ í•  ê²ƒì´ê¸°ì— writeë¥¼ ì–´ëŠì •ë„ í¬ìƒí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì§„í–‰í•˜ë ¤ í•œë‹¤.

ê¸°ë„ ì œëª© ì¢‹ì•„ìš”ì— ëŒ€í•´ì„œ writeëŠ” event driven ì ìš©ìœ¼ë¡œ ë¹„ë™ê¸° ìˆ˜í–‰í•  ê²ƒì´ê¸°ì— í”„ë¡ íŠ¸ ë‹¨ì—ì„œëŠ” í¬ê²Œ ì„±ëŠ¥ìƒ ì°¨ì´ë¥¼ ëŠë¼ì§€ëŠ” ì•Šì„ ê²ƒì´ë‹¤.

- `(member_id, prayer_lapse_id DESC)` 

index ë’¤ ìª½ì— prayer_lapse_idë¥¼ ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ í•œ ì´ìœ ëŠ” prayer_lapseë¥¼ ìµœì‹  ìˆœìœ¼ë¡œ ë³´ì—¬ì¤„ ê²ƒì´ê¸°ì— descending orderingì´ í•„ìš”
indexì— DESC ì„¤ì •ì´ ì—†ìœ¼ë©´ `Backward index scan; Using index` ë‚˜ì˜¤ê²Œ ë˜ëŠ”ë° ì´ëŠ” Mysql ìƒì—ì„œ ì„±ëŠ¥ì´ ì•½ê°„ ë–¨ì–´ì§([ë§í¬ ì°¸ê³ ](https://tech.kakao.com/posts/351))
(ascending index ìƒí™©ì—ì„œ desc ì •ë ¬ì„ í•´ì•¼í•˜ëŠ” ìƒí™©)

ê·¸ë˜ì„œ descending index ì„¤ì •ì„ í†µí•´ covering indexì˜ ì„±ëŠ¥ì„ ë” í–¥ìƒí•  ìˆ˜ ìˆë‹¤ê³  ìƒê°í•˜ì—¬ ê·¸ë ‡ê²Œ ì¸ë±ìŠ¤ ì„¤ì •